"use strict";(self["webpackChunkgmtc_2021_webgpu_slide"]=self["webpackChunkgmtc_2021_webgpu_slide"]||[]).push([[177],{3832:(e,a,s)=>{s.d(a,{Z:()=>w});var t=s(1959),l=s(3673);function w(e){const a=(0,t.iH)(0),s=s=>{if(" "===s.key||"Spacebar"===s.key){if(a.value===e)return void(a.value=0);a.value++}};return(0,l.bv)((()=>{window.addEventListener("keyup",s)})),(0,l.Jd)((()=>{window.removeEventListener("keyup",s)})),{show:a}}},3177:(e,a,s)=>{s.r(a),s.d(a,{default:()=>Pe});var t=s(3673);const l={key:0,class:"row justify-center items-center content-center wrap q-gutter-md text-white text-left text-h4 text-weight-regular"},w=(0,t._)("div",{class:"col-10 text-center text-h3 text-weight-bold"}," 多线程（2022年？） ",-1),i=(0,t._)("div",{class:"col-10 p-box q-pa-md"},[(0,t._)("ul",null,[(0,t._)("li",{class:"q-py-md"},"多线程是现代图形 API 的一个关键部分。与 OpenGL 不同，较新的 API 允许应用程序同时从多个线程编码命令、提交操作、向 GPU 传输数据等等，从而缓解了 CPU 的瓶颈。"),(0,t._)("li",{class:"q-py-md"},"多线程对于 WebGPU 特别重要，因为 IDL 绑定通常比 C 调用慢得多"),(0,t._)("li",{class:"q-py-md"},"一个 WebGPU 对象可以简单地被 postMessage() 到另一个线程，创建一个新的 WebGPU 对象，其中包含一个指向 GPU 进程中同一个（引用计数）对象的句柄")])],-1),r=[w,i],d={key:1,class:"row justify-center items-center content-center wrap q-gutter-md text-white text-left text-h4 text-weight-regular full-width"},o=(0,t._)("div",{class:"col-10 text-center text-h3 text-weight-bold"}," 主线程 与 子线程 的对话 ",-1),n=(0,t._)("span",{class:"text-h5"},"主线程",-1),c={key:1,class:"q-pa-md"},p=(0,t._)("span",{class:"text-h5"},"主线程",-1),g={key:1,class:"q-pa-md"},v=(0,t._)("span",{class:"text-h5"},"主线程",-1),m=(0,t._)("div",{class:"text-h4 q-mt-sm q-mb-xs"},"B1",-1),u=(0,t._)("div",{class:"text-h6 text-grey"}," GPUBuffer: 16 MB ",-1),k=(0,t.Uk)(" 发送自 postMessage() "),h=(0,t._)("span",{class:"text-h5"},"子线程",-1),q={key:1,class:"q-pa-md"},_=(0,t._)("span",{class:"text-h5"},"子线程",-1),y={key:1,class:"q-pa-md"},f=(0,t._)("div",null,"const mapPromise = B2.mapAsync()",-1),j=(0,t._)("div",{class:"text-red text-h6"},"未发送",-1),x=[f,j],b=(0,t._)("span",{class:"text-h5"},"主线程",-1),P={key:1,class:"q-pa-md"},D=(0,t._)("span",{class:"text-h5"},"主线程",-1),z={key:1,class:"q-pa-md"},M=(0,t._)("span",{class:"text-h5"},"子线程",-1),B={key:1,class:"q-pa-md"},Z=(0,t._)("span",{class:"text-h5"},"主线程",-1),U={key:1,class:"q-pa-md"},W=(0,t._)("span",{class:"text-h5"},"主线程",-1),G={key:1,class:"q-pa-md"},Q=(0,t._)("div",null,"encoder.copyBufferToTexture(B1, T);",-1),A=(0,t._)("div",null,"const commandBuffer = encoder.finish();",-1),C=[Q,A],S=(0,t._)("span",{class:"text-h5"},"主线程",-1),I={key:1,class:"q-pa-md"},L=(0,t._)("span",{class:"text-h5"},"主线程",-1),T={key:1,class:"q-pa-md"},E=(0,t._)("span",{class:"text-h5"},"主线程",-1),H={key:1,class:"q-pa-md"},J=(0,t._)("span",{class:"text-h5"},"主线程",-1),O={key:1,class:"q-pa-md"},F=(0,t._)("span",{class:"text-h5"},"主线程",-1),K={key:1,class:"q-pa-md"},N=(0,t._)("span",{class:"text-h5"},"子线程",-1),R={key:1,class:"q-pa-md"},V=(0,t._)("div",null,"因为 CPU 目前依然掌握着此缓冲区的所有权!",-1),X=(0,t._)("div",null,"稍等……",-1),Y=[V,X],$=(0,t._)("span",{class:"text-h5"},"子线程",-1),ee={key:1,class:"q-pa-md"},ae=(0,t._)("div",null,"await mapPromise",-1),se=(0,t._)("div",null,"B2.unmap()",-1),te=[ae,se],le=(0,t._)("span",{class:"text-h5"},"子线程",-1),we={key:1,class:"q-pa-md"},ie=(0,t._)("span",{class:"text-h5"},"主线程",-1),re={key:1,class:"q-pa-md"},de=(0,t._)("span",{class:"text-h5"},"主线程",-1),oe={key:1,class:"q-pa-md"};function ne(e,a,s,w,i,f){const j=(0,t.up)("q-spinner-dots"),Q=(0,t.up)("q-chat-message"),A=(0,t.up)("q-card-section"),V=(0,t.up)("q-icon"),X=(0,t.up)("q-separator"),ae=(0,t.up)("q-btn"),se=(0,t.up)("q-card-actions"),ne=(0,t.up)("q-card"),ce=(0,t.up)("q-scroll-area"),pe=(0,t.up)("q-page");return(0,t.wg)(),(0,t.j4)(pe,{class:"flex flex-center"},{default:(0,t.w5)((()=>[0===e.show?((0,t.wg)(),(0,t.iD)("div",l,r)):(0,t.kq)("",!0),e.show>=1?((0,t.wg)(),(0,t.iD)("div",d,[o,(0,t.Wm)(ce,{ref:"scrollArea",class:"col-10 text-h4 text-weight-bold q-px-xl",style:{height:"700px"}},{default:(0,t.w5)((()=>[e.show>=2?((0,t.wg)(),(0,t.j4)(Q,{key:0,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive"},{name:(0,t.w5)((()=>[n])),default:(0,t.w5)((()=>[(0,t._)("div",null,[2===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=3?((0,t.wg)(),(0,t.iD)("div",c,"const B1 = device.createBuffer(...);")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=4?((0,t.wg)(),(0,t.j4)(Q,{key:1,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive"},{name:(0,t.w5)((()=>[p])),default:(0,t.w5)((()=>[(0,t._)("div",null,[4===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=5?((0,t.wg)(),(0,t.iD)("div",g,"嘿，我有个 B1 的 Buffer，你要不要看看？")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=6?((0,t.wg)(),(0,t.j4)(Q,{key:2,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"",stamp:"PM 22:00"},{name:(0,t.w5)((()=>[v])),default:(0,t.w5)((()=>[(0,t._)("div",null,[6===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=7?((0,t.wg)(),(0,t.j4)(ne,{key:1,flat:"",bordered:"",class:"bg-grey-3",style:{width:"350px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(A,{horizontal:"",class:"justify-between"},{default:(0,t.w5)((()=>[(0,t.Wm)(A,{class:"col q-pt-xs"},{default:(0,t.w5)((()=>[m,u])),_:1}),(0,t.Wm)(A,{class:"col-5 flex flex-center"},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{name:"memory",class:"text-accent",style:{"font-size":"64px"}})])),_:1})])),_:1}),(0,t.Wm)(X),(0,t.Wm)(se,null,{default:(0,t.w5)((()=>[(0,t.Wm)(ae,{flat:"",round:"",icon:"event"}),(0,t.Wm)(ae,{flat:""},{default:(0,t.w5)((()=>[k])),_:1})])),_:1})])),_:1})):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=8?((0,t.wg)(),(0,t.j4)(Q,{key:3,avatar:"https://cdn.quasar.dev/img/avatar3.jpg","bg-color":"grey-2",stamp:"PM 22:00"},{name:(0,t.w5)((()=>[h])),default:(0,t.w5)((()=>[(0,t._)("div",null,[8===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=9?((0,t.wg)(),(0,t.iD)("div",q,"收到了，另存为 B2")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=10?((0,t.wg)(),(0,t.j4)(Q,{key:4,avatar:"https://cdn.quasar.dev/img/avatar3.jpg","bg-color":"grey-2",stamp:"PM 22:01"},{name:(0,t.w5)((()=>[_])),default:(0,t.w5)((()=>[(0,t._)("div",null,[10===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=11?((0,t.wg)(),(0,t.iD)("div",y,x)):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=11?((0,t.wg)(),(0,t.j4)(Q,{key:5,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:01"},{name:(0,t.w5)((()=>[b])),default:(0,t.w5)((()=>[(0,t._)("div",null,[11===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=12?((0,t.wg)(),(0,t.iD)("div",P,"B1.mapAsync()")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=13?((0,t.wg)(),(0,t.j4)(Q,{key:6,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:01"},{name:(0,t.w5)((()=>[D])),default:(0,t.w5)((()=>[(0,t._)("div",null,[13===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=14?((0,t.wg)(),(0,t.iD)("div",z,"我这里报错了，是你做了什么吗？")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=15?((0,t.wg)(),(0,t.j4)(Q,{key:7,avatar:"https://cdn.quasar.dev/img/avatar3.jpg","bg-color":"grey-2",stamp:"PM 22:02"},{name:(0,t.w5)((()=>[M])),default:(0,t.w5)((()=>[(0,t._)("div",null,[15===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=16?((0,t.wg)(),(0,t.iD)("div",B,"因为我这里已经对这个 GPUBuffer 进行 mapAsync() 操作了")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=17?((0,t.wg)(),(0,t.j4)(Q,{key:8,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:03"},{name:(0,t.w5)((()=>[Z])),default:(0,t.w5)((()=>[(0,t._)("div",null,[17===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=18?((0,t.wg)(),(0,t.iD)("div",U,"那我来做些别的事吧")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=19?((0,t.wg)(),(0,t.j4)(Q,{key:9,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:03"},{name:(0,t.w5)((()=>[W])),default:(0,t.w5)((()=>[(0,t._)("div",null,[19===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=20?((0,t.wg)(),(0,t.iD)("div",G,C)):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=21?((0,t.wg)(),(0,t.j4)(Q,{key:10,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:04"},{name:(0,t.w5)((()=>[S])),default:(0,t.w5)((()=>[(0,t._)("div",null,[21===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=22?((0,t.wg)(),(0,t.iD)("div",I,"为什么这次我这里没有报错呢？")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=23?((0,t.wg)(),(0,t.j4)(Q,{key:11,avatar:"https://cdn.quasar.dev/img/avatar3.jpg","bg-color":"grey-2",stamp:"PM 22:04"},{name:(0,t.w5)((()=>[L])),default:(0,t.w5)((()=>[(0,t._)("div",null,[23===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=24?((0,t.wg)(),(0,t.iD)("div",T,"你这次没有报错，因为你做的操作不依赖于 GPUBuffer 的映射状态")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=25?((0,t.wg)(),(0,t.j4)(Q,{key:12,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:05"},{name:(0,t.w5)((()=>[E])),default:(0,t.w5)((()=>[(0,t._)("div",null,[25===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=26?((0,t.wg)(),(0,t.iD)("div",H,"好的，那我就提交 GPU 执行了")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=27?((0,t.wg)(),(0,t.j4)(Q,{key:13,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:05"},{name:(0,t.w5)((()=>[J])),default:(0,t.w5)((()=>[(0,t._)("div",null,[27===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=28?((0,t.wg)(),(0,t.iD)("div",O," device.queue.submit([commandBuffer]); ")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=29?((0,t.wg)(),(0,t.j4)(Q,{key:14,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:06"},{name:(0,t.w5)((()=>[F])),default:(0,t.w5)((()=>[(0,t._)("div",null,[29===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=30?((0,t.wg)(),(0,t.iD)("div",K," 咦，为什么我这里又报错了？ ")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=31?((0,t.wg)(),(0,t.j4)(Q,{key:15,avatar:"https://cdn.quasar.dev/img/avatar3.jpg","bg-color":"grey-2",stamp:"PM 22:07"},{name:(0,t.w5)((()=>[N])),default:(0,t.w5)((()=>[(0,t._)("div",null,[31===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=32?((0,t.wg)(),(0,t.iD)("div",R,Y)):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=33?((0,t.wg)(),(0,t.j4)(Q,{key:16,avatar:"https://cdn.quasar.dev/img/avatar3.jpg","bg-color":"grey-2",stamp:"PM 22:07"},{name:(0,t.w5)((()=>[$])),default:(0,t.w5)((()=>[(0,t._)("div",null,[33===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=34?((0,t.wg)(),(0,t.iD)("div",ee,te)):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=35?((0,t.wg)(),(0,t.j4)(Q,{key:17,avatar:"https://cdn.quasar.dev/img/avatar3.jpg","bg-color":"grey-2",stamp:"PM 22:08"},{name:(0,t.w5)((()=>[le])),default:(0,t.w5)((()=>[(0,t._)("div",null,[35===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=36?((0,t.wg)(),(0,t.iD)("div",we," 好了，你再试试！ ")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=37?((0,t.wg)(),(0,t.j4)(Q,{key:18,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:09"},{name:(0,t.w5)((()=>[ie])),default:(0,t.w5)((()=>[(0,t._)("div",null,[37===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=38?((0,t.wg)(),(0,t.iD)("div",re," device.queue.submit([commandBuffer]); ")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0),e.show>=39?((0,t.wg)(),(0,t.j4)(Q,{key:19,avatar:"https://cdn.quasar.dev/img/avatar4.jpg",sent:"","bg-color":"positive",stamp:"PM 22:10"},{name:(0,t.w5)((()=>[de])),default:(0,t.w5)((()=>[(0,t._)("div",null,[39===e.show?((0,t.wg)(),(0,t.j4)(j,{key:0,size:"2rem"})):(0,t.kq)("",!0),e.show>=40?((0,t.wg)(),(0,t.iD)("div",oe," 好了，这次成功了！ ")):(0,t.kq)("",!0)])])),_:1})):(0,t.kq)("",!0)])),_:1},512)])):(0,t.kq)("",!0)])),_:1})}var ce=s(1959),pe=s(3832);const ge=(0,t.aZ)({setup(){const{show:e}=(0,pe.Z)(40),a=(0,ce.iH)(null);let s=0;return(0,t.m0)((()=>{e.value>=2&&(s+=80,a.value.setScrollPosition("vertical",s,500))})),{show:e,scrollArea:a}}});var ve=s(4379),me=s(7704),ue=s(629),ke=s(4765),he=s(151),qe=s(5589),_e=s(4554),ye=s(5869),fe=s(9367),je=s(8240),xe=s(7518),be=s.n(xe);ge.render=ne;const Pe=ge;be()(ge,"components",{QPage:ve.Z,QScrollArea:me.Z,QChatMessage:ue.Z,QSpinnerDots:ke.Z,QCard:he.Z,QCardSection:qe.Z,QIcon:_e.Z,QSeparator:ye.Z,QCardActions:fe.Z,QBtn:je.Z})}}]);